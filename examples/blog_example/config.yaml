server:
  address: "localhost:8080"
  session_secret: "${file:SESSION_SECRET}"
  session_name: "sargantana_session"
  secrets_dir: "./secrets"
  redis_session_store:  # TLS-enabled Redis for session storage
    address: "localhost:6380"  # TLS Redis server address
    username: "redisuser"           # Redis password (if any)
    password: "redispass"           # Redis password (if any)
    database: 0                  # Redis database number
    max_idle: 10          # Max idle connections
    idle_timeout: "2m"     # Idle timeout in seconds
    tls:                   # TLS configuration for secure connections
      insecure_skip_verify: true   # Skip certificate verification for self-signed certs
      cert_file: "../../certs/redis.crt"  # Client certificate file
      key_file: "../../certs/redis.key"   # Client private key file
      ca_file: "../../certs/ca.crt"        # CA certificate file

database: # postgresql
  host: "localhost"
  port: 5432
  database: my_blog_db
  user: ${file:DB_USER}
  password: ${file:DB_PASSWORD}

controllers:
  - type: "template"
    name: "templates"
    config:
      path: "./templates"

  - type: "static"
    config:
      - path: "css"
        dir: "./css"
      - path: "favicon.ico"
        file: "./favicon.ico"

  - type: "blog"
    name: "my_blog"
    config:
      feed_path: "/blog/feed"
      post_path: "/blog/post"
      admin_area_path: "/blog/admin"

  - type: "auth"
    config:
      callback_host: "http://localhost:8080"
      login_path: "/auth/{provider}"
      logout_path: "/logout"
      callback_path: "/auth/{provider}/callback"
      user_info_path: "/user"
      redirect_on_login: "/blog/feed"
      redirect_on_logout: "/blog/feed"
      providers:
        openid-connect:
          key: "${file:OPENID_CONNECT_KEY}"
          secret: "${file:OPENID_CONNECT_SECRET}"
          url: "http://localhost:8081/default/.well-known/openid-configuration"
          scopes:
            - "openid"
            - "profile"
            - "email"
        google:
          key: "${file:GOOGLE_KEY}"
          secret: "${file:GOOGLE_SECRET}"
          scopes:
            - "openid"
            - "profile"
            - "email"